/* ===== Full-screen Responsive Layout ===== */
:root{
  --tx-primary:#0AA0A6;
  --line:#d7e7f7;
  --chip-bg:#eef6fa; --chip-ink:#247;
  --muted:#5e6b7a; --panel:#fff; --bg:#f6fafc;
  --radius:12px;
}

html,body{height:100%; margin:0;}
body{font:14px/1.6 "Noto Sans JP", system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; color:#123; background:var(--bg);}
.app{height:100dvh; display:flex; flex-direction:column; min-width:960px;}

.ps-header{
  flex:0 0 auto; height:64px; display:grid;
  grid-template-columns: 1fr minmax(520px, 1.2fr) auto;
  align-items:center; gap:12px; padding:10px 14px;
  background:#fff; border-bottom:1px solid var(--line);
}
.ps-header .left{display:flex; align-items:center; gap:12px; min-width:0;}
.app-title{margin:0; font-size:18px; white-space:nowrap;}
.ps-header .middle{
  display:grid; grid-template-columns: auto 110px auto 110px auto minmax(280px,1fr);
  align-items:center; gap:8px; min-width:520px;
}
.label{font-size:12px; color:var(--muted); white-space:nowrap;}
.ps-header .right{display:flex; gap:8px;}

.input{background:#fff; border:1px solid var(--line); border-radius:8px; padding:8px 10px; min-width:0; outline:none;}
.input.sm{padding:6px 8px;}
.input.wide{width:100%;}
.btn{background:var(--tx-primary); color:#fff; border:none; border-radius:10px; padding:9px 14px; cursor:pointer; font-weight:700;}
.btn.secondary{background:#0d2330; color:#fff;}
.btn.ghost{background:#fff; color:#0d2330; border:1px solid var(--line);}

.ps-main{
  flex:1 1 auto; min-height:0; /* これが重要：子要素のoverflowを許可 */
  display:grid; grid-template-columns: clamp(260px, 18vw, 340px) 1fr; gap:16px;
  padding:16px; overflow:hidden; /* 全体の二重スクロール防止 */
}

.panel{background:var(--panel); border:1px solid var(--line); border-radius:var(--radius); min-height:0;}

/* Sidebar */
.ps-side{display:flex; flex-direction:column; min-width:0; resize:horizontal; overflow:auto;}
.tips{color:var(--muted); padding:12px 12px 4px;}
.ps-side .input{margin:0 12px 10px;}
.filelist{padding:0 12px 12px; display:flex; flex-direction:column; gap:8px;}
.fileitem{display:flex; align-items:center; justify-content:space-between; gap:8px; padding:10px; border:1px solid var(--line); border-radius:10px; background:#fff; cursor:pointer;}
.fileitem.active{outline:2px solid #0aa0a633;}
.fileitem .name{font-weight:700; color:#134; min-width:0; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;}
.fileitem .meta{display:flex; gap:6px; align-items:center;}
.chip{background:var(--chip-bg); color:var(--chip-ink); padding:2px 8px; border-radius:999px; font-size:12px; border:1px solid var(--line); white-space:nowrap;}
.chip.ok{color:#066; background:#e7faf8; border-color:#b8efe9;}
.chip.warn{color:#764f00; background:#fff5d6; border-color:#f4e1a4;}
.chip.info{color:#124a7a; background:#e8f2ff; border-color:#cfe2ff;}

/* Editor */
.ps-editor{display:flex; flex-direction:column; min-width:0; min-height:0; overflow:hidden;}
.bar.meta{
  flex:0 0 auto; display:grid; grid-template-columns: repeat(2, auto) repeat(2, auto) auto 1fr;
  align-items:center; gap:8px; padding:12px; border-bottom:1px solid var(--line);
}
.file-caption{color:var(--muted);}
.filename{font-weight:700; min-width:0; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;}

.tab-header{
  flex:0 0 auto; display:flex; gap:8px; padding:10px 12px; border-bottom:1px solid var(--line);
}
.tab-button{background:#f6fbff; border:1px solid var(--line); color:#134; border-radius:8px; padding:8px 12px; cursor:pointer;}
.tab-button.active{background:#fff; border-bottom-color:#fff; font-weight:700;}

.tab-wrap{flex:1 1 auto; min-height:0; display:flex; flex-direction:column; overflow:hidden;}
.tab-panel{display:none; flex:1 1 auto; min-height:0; overflow:auto;}
.tab-panel.active{display:block;}
#promptTab{padding:12px; height:100%;}
#promptEditor{
  width:100%; height:100%; min-height:0;
  border:1px solid var(--line); border-radius:10px; padding:12px;
  resize:none; box-sizing:border-box; background:#fbfeff;
  font:13px/1.7 ui-monospace, Menlo, Consolas, "Noto Sans JP";
  white-space:pre-wrap; overflow:auto;
}

/* パラメータ */
#paramsTab{padding:12px;}
.param-grid{display:grid; grid-template-columns: repeat(2, minmax(320px, 1fr)); gap:16px;}
.slider-group{background:#fcfeff; border:1px solid var(--line); border-radius:10px; padding:10px 12px;}
.slider-label{display:flex; align-items:center; justify-content:space-between; gap:12px; white-space:nowrap;}
.slider-value{color:#134; font-weight:700;}
input[type="range"]{width:100%;}

#statusMessage{flex:0 0 auto; padding:8px 12px; color:#0AA0A6;}

.diff{flex:0 0 auto; border-top:1px dashed var(--line); padding:12px;}
.diff-head{font-weight:700; color:#345; margin:.5em 0 10px;}
.diff-cols{display:grid; grid-template-columns:1fr 1fr; gap:12px;}
.diff textarea{
  width:100%; height:240px; font:12px/1.6 ui-monospace, "Noto Sans JP";
  background:#f9fcff; border:1px dashed var(--line); border-radius:8px; padding:10px; resize:none;
}

/* Responsive */
@media (max-width: 1200px){
  .param-grid{grid-template-columns: 1fr;}
}
@media (max-width: 1100px){
  .ps-header{grid-template-columns: 1fr; height:auto; row-gap:8px; padding:8px 14px;}
  .ps-main{grid-template-columns: clamp(240px, 22vw, 320px) 1fr;}
}
